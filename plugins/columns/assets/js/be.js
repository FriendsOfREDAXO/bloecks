bloecks.addPlugin("columns",{init:function(){var a=this;$(".rex-slices").each(function(b,c){try{$(c).sortable("destroy")}catch(a){}$(c).find(".rex-slice form").length?$(c).addClass("is--editing"):a.addResizables(c)})},getGrid:function(a){return[Math.ceil($(a).outerWidth()/4),Math.ceil($(a).find(".rex-slice-select").last().outerHeight())]},addResizables:function(a){var b=this;$(a).find(">.rex-slice.rex-slice-output").each(function(a,c){var d=[];b.getItemData(c,"columns").min!=b.getItemData(c,"columns").max&&d.push("e"),b.getItemData(c,"rows").min!=b.getItemData(c,"rows").max&&d.push("s"),d=d.join(", "),d&&$(c).resizable({containment:document.body,handles:d,stop:function(a,c){var d=$(this).resizable("option","grid"),e=Math.round(c.size.width/d[0]),f=Math.round(c.size.height/d[1]),g=b.getItemData(this,"columns");if(this_id=bloecks.getSliceId(this),$(this).css({width:Math.round(e/g.grid*1e4)/100+"%"}),null!==this_id){console.log("Update format of "+this_id);var h=window.location.href.replace(/page=([^&]+)/,"page=bloecks/columns/resize").replace(/(&|\?)resize[(\d+)][x]=(\d+)/g,"").replace(/(&|\?)resize[(\d+)][y]=(\d+)/g,"");h+=(h.indexOf("?")>-1?"&":"?")+"resize["+this_id+"][x]="+e+"&resize["+this_id+"][y]="+f,bloecks.executePjax(h)}},resize:function(a,b){var c=$(this).resizable("option","grid");b.size.width=Math.floor(b.size.width/c[0])*c[0],b.size.height=Math.floor(b.size.height/c[1])*c[1]}})}),this.updateOnResize(a)},getItemData:function(a,b){var c={},d=($(a).attr("data-bloecks-"+b)||"").split(",");return c.grid="undefined"!=typeof d[1]?parseInt(d[1]):1,c.grid=Math.max(1,isNaN(c.grid)?1:c.grid),c.min="undefined"!=typeof d[2]?parseInt(d[2]):1,c.min=Math.max(1,isNaN(c.min)?1:c.min),c.min=Math.min(c.grid,c.min),c.max="undefined"!=typeof d[3]?parseInt(d[3]):1,c.max=Math.max(c.min,isNaN(c.max)?c.min:c.max),c.max=Math.min(c.grid,c.max),c.size="undefined"!=typeof d[0]?parseInt(d[0]):c.min,c.size=Math.max(1,isNaN(c.size)?c.min:c.size),c.size=Math.min(c.size,c.max),c},updateOnResize:function(a){var b=this,c={rows:$(a).find(".rex-slice-select").last().outerHeight(),columns:$(a).outerWidth()};$(a).find(">.rex-slice.rex-slice-output.ui-resizable").each(function(a,d){var e={rows:{},columns:{}},f={};for(var g in e){($(d).attr("data-bloecks-"+g)||"").split(",");e[g]=b.getItemData(d,g),e[g].grid=c[g]/e[g].grid,e[g].min=Math.ceil(e[g].grid*e[g].min),e[g].max=Math.ceil(e[g].grid*e[g].max),e[g].grid=Math.floor(e[g].grid),f["min"+("rows"==g?"Height":"Width")]=e[g].min,f["max"+("rows"==g?"Height":"Width")]=e[g].max}f.grid=[e.columns.grid,e.rows.grid],$(d).resizable("option",f)})}});
//# sourceMappingURL=be.js.map