bloecks.addPlugin("dragndrop",{init:function(){const i=this;$(".rex-slices:not(.is--undraggable)").each(function(e,t){try{$(t).sortable("destroy")}catch(e){}$(t).find(".rex-slice.rex-slice-edit, .rex-slice.rex-slice-add").length?$(t).addClass("is--editing"):i.addSortables(t)})},markDisabledItems:function(e,i="ui-state-disabled"){$(e).find(".rex-slice-output:not(."+i+")").each(function(e,t){$(t).find('[href*="direction=move"]').length||$(t).addClass(i)})},addSortables:function(i){var e="ui-state-disabled";this.markDisabledItems(i,e),$(i).sortable({appendTo:document.body,handle:".rex-page-section>.panel>.panel-heading",placeholder:"rex-slice rex-slice-placeholder",cancel:"."+e,helper:"clone",items:">.rex-slice.rex-slice-draggable",create:function(e,t){$(i).css({minHeight:$(i).outerHeight()})},start:function(e,t){$(this).addClass("ui-state-sorting"),$(this).sortable("refreshPositions"),t.placeholder.height(t.helper.outerHeight())},stop:function(e,t){$(this).hasClass("ui-state-updated")||$(this).removeClass("ui-state-sorting")},update:function(e,t){$(this).addClass("ui-state-updated"),$(this).sortable("refresh");var i=t.position.top<t.originalPosition.top?"up":"down",s=bloecks.getSliceId(t.item),l=t.item.prevAll(".rex-slice-draggable").length?bloecks.getSliceId(t.item.prevAll(".rex-slice-draggable").first()):0;if(null!==s&&null!==l){let e=t.item.find(`[href*="direction=move${i}"]`).length?t.item.find(`[href*="direction=move${i}"]`).first().attr("href"):null;null!==e?(e=(e=(e=e.replace(/(&amp;|&)direction=move(up|down)/,"$1direction=move$2$1insertafter="+l)).replace(/content_move_slice/,"content_move_slice_to")).replace(/_csrf_token=[^&]+/,"_csrf_token="+t.item.data("csrf-token")),e+="#slice"+s):e=window.location.href,bloecks.executePjax(e)}}})}});