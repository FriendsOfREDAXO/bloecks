var bloecks_code={init:function(){$(document).on("keydown.bloecks","textarea.bloecks--code",function(e){bloecks_code.handleKeyDown(e,this)})},handleKeyDown:function(e,t){switch(e.keyCode){case 9:e.preventDefault(),e.shiftKey?bloecks_code.jumpToPreviousTab(t):bloecks_code.insertTextAtCursor(t,"\t");break;case 13:e.preventDefault(),bloecks_code.insertLinebreakAtCursor(t)}},insertLinebreakAtCursor:function(e){var t=e.value.slice(0,e.selectionStart).match(/(\n|^)(\t+|\s+)?[^\n]*$/);t&&void 0!==t[2]?this.insertTextAtCursor(e,"\n"+t[2]):this.insertTextAtCursor(e,"\n")},jumpToPreviousTab:function(e){var t=e.value,n=t.substring(0,e.selectionStart).match(/(\t+|\s+)$/);n&&void 0!==n[0]&&(n=e.selectionStart-n[0].length,e.value=t.substring(0,n)+t.substring(e.selectionEnd),e.selectionStart=e.selectionEnd=n)},insertTextAtCursor:function(e,t){var n=e.value,i=e.selectionStart,s=e.selectionEnd,n=(e.value=n.substring(0,i)+t+n.substring(s),i+t.length);e.selectionStart=n,e.selectionEnd=n}},bloecks_fragments=($(document).on("ready.bloecks",function(){bloecks_code.init()}),{init:function(){this.setupEventListeners()},setupEventListeners:function(){$(document).on("change.bloecks",'.bloecks--setting input[type="checkbox"][name*="[active]"]',function(){bloecks_fragments.toggle(this)})},toggle:function(e){var e=$(e),t=e.is(":checked"),e=e.attr("id"),e=$("."+e);t?e.removeClass("is--hidden"):e.addClass("is--hidden")}}),bloecks=($(document).on("rex:ready ready.bloecks",function(){bloecks_fragments.init(),$('.bloecks--setting input[type="checkbox"][name*="[active]"]').change()}),{plugins:[],init:function(){this.getPlugins(!0).forEach(function(e){bloecks[e]&&"function"==typeof bloecks[e].init&&bloecks[e].init()})},getSliceId:function(e){let t=null,n=$(e);if((n=n.is(".rex-slice-output")?n:n.closest(".rex-slice-output")).length){let e=n.find('[href*="slice_id="]').first().attr("href");e?t=parseInt(e.match(/slice_id=(\d+)/)[1],10):n.attr("id")&&(t=parseInt(n.attr("id").replace(/\D/g,""),10))}return t},executePjax:function(e){e=e.replace(/(#[^\?\&]+)/,"")+(e.match(/(#[^\?\&]+)/)?e.match(/(#[^\?\&]+)/)[0]:"");$.pjax({url:e,container:"#rex-js-page-main-content",fragment:"#rex-js-page-main-content",push:!1})},getPlugins:function(t){return this.plugins.filter(function(e){return"string"==typeof e&&void 0!==bloecks[e]&&(!t||"function"==typeof bloecks[e].init)})},addPlugin:function(e,t,n){for(this[e]=t,n=isNaN(parseInt(n))?this.plugins.length:Math.max(parseInt(n),0);this.plugins.length<n;)this.plugins.push(void 0);this.plugins.splice(n,0,e)}});$(document).on("rex:ready",function(){bloecks.init()});